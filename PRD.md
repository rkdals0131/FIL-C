# Product Requirements Document (PRD)
## Fine-grained Interpolation for LiDAR Continuity (filc)

## 1. ν„μ¬ κ°λ° μƒν™©

### μ™„λ£λ μ‘μ—… β…
- **ν•µμ‹¬ λ³΄κ°„ μ—”μ§„**: `improved_interpolation_node` κµ¬ν„ μ™„λ£
  - 32β†’128 μ±„λ„ μ‹¤μ‹κ°„ λ³΄κ°„ (>10Hz)
  - XYZ μ§μ ‘ λ³΄κ°„ λ°©μ‹ (μ•μ •μ„± μµμ°μ„ )
  - μ μ‘μ  λ¶μ—°μ†μ„± μ²λ¦¬
  - OpenMP λ³‘λ ¬ν™”

- **μΈν”„λΌ κµ¬μ¶•**
  - ROS2 ν¨ν‚¤μ§€ κµ¬μ΅° μ •λ¦½
  - Launch μ‹μ¤ν… λ° μ„¤μ • νμΌ
  - μ‹¤μ‹κ°„ λ¨λ‹ν„°λ§ λ„κµ¬
  - μ„±λ¥ λ²¤μΉλ§ν¬ μ‹μ¤ν…

- **λ¬Έμ  ν•΄κ²°**
  - 2D μ΄λ―Έμ§€ λ³΄κ°„ β†’ 3D μ§μ ‘ λ³΄κ°„μΌλ΅ μ „ν™
  - QoS νΈν™μ„± (best_effort)
  - νμΌ κµ¬μ΅° κ°„μ†ν™”

### μ§„ν–‰ μ¤‘μΈ μ‘μ—… π”„
- μ„±λ¥ ν”„λ΅νμΌλ§ λ° μµμ ν™”
- λ°νƒ€μ„ νλΌλ―Έν„° λ™μ  λ³€κ²½ κΈ°λ¥

## 2. μ‹μ¤ν… μ•„ν‚¤ν…μ²

### λ…Έλ“ κµ¬μ΅°
```
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚ Ouster LiDAR    β”‚
β”‚   (OS1-32)      β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”¬β”€β”€β”€β”€β”€β”€β”€β”€β”
         β”‚ /ouster/points
         β”‚ (32Γ—1024)
         β–Ό
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚ improved_interpolation  β”‚
β”‚        _node            β”‚
β”‚ β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β” β”‚
β”‚ β”‚ 1. ν¬μΈνΈ μμ‹       β”‚ β”‚
β”‚ β”‚ 2. μ μ‘μ  λ³΄κ°„      β”‚ β”‚
β”‚ β”‚ 3. λ³‘λ ¬ μ²λ¦¬        β”‚ β”‚
β”‚ β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β” β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”¬β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
         β”‚ /ouster/improved_interpolated_points
         β”‚ (128Γ—1024)
         β–Ό
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚ λ‹¤μ΄μ¤νΈλ¦Ό μ²λ¦¬ β”‚
β”‚ (SLAM, κ²€μ¶ λ“±) β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
```

### λ°μ΄ν„° νλ¦„
1. **μ…λ ¥**: Organized PointCloud2 (32 rows Γ— 1024 cols)
2. **λ³΄κ°„ κ³Όμ •**:
   - μ›λ³Έ ν¬μΈνΈ λ³΄μ΅΄
   - μ±„λ„ κ°„ μƒ ν¬μΈνΈ μƒμ„±
   - λ¶μ—°μ†μ„± κ°μ§€ (>0.5m)
   - μ μ‘μ  λ³΄κ°„ λ°©λ²• μ„ νƒ
3. **μ¶λ ¥**: Organized PointCloud2 (128 rows Γ— 1024 cols)

### ν•µμ‹¬ μ•κ³ λ¦¬μ¦
```cpp
// μμ‚¬ μ½”λ“
for each column:
    for each channel gap:
        if (discontinuity > threshold):
            use_nearest_neighbor()
        else:
            use_linear_interpolation()
```

## 3. κΈ°μ  μ¤νƒ

### μμ΅΄μ„±
- **ν•„μ**: ROS2, PCL, Eigen3, OpenMP
- **μ„ νƒ**: OpenCV (ν–¥ν›„ μ΄λ―Έμ§€ νΉμ§• ν†µν•©μ©)

### μ„±λ¥ μ§€ν‘
- **μ²λ¦¬ μ‹κ°„**: ~50ms @ 4x scale
- **λ©”λ¨λ¦¬ μ‚¬μ©**: <500MB
- **CPU ν™μ©**: λ©€ν‹°μ½”μ–΄ λ³‘λ ¬ν™”

## 4. ν–¥ν›„ κ°λ° κ³„ν

### Phase 1: μµμ ν™” (1-2μ£Ό)
- [ ] SIMD λ…λ Ήμ–΄ ν™μ©
- [ ] λ©”λ¨λ¦¬ μ ‘κ·Ό ν¨ν„΄ μµμ ν™”
- [ ] λ™μ  νλΌλ―Έν„° μ¬μ„¤μ •

### Phase 2: μΉ΄λ©”λΌ μµν•© (3-4μ£Ό)
- [ ] RGB μΉ΄λ©”λΌ λ™κΈ°ν™” λ¨λ“
- [ ] μΊλ¦¬λΈλ μ΄μ… λ„κµ¬
- [ ] ν¬μΈνΈλ³„ μƒ‰μƒ λ§¤ν•‘

### Phase 3: κ³ κΈ‰ κΈ°λ¥ (1-2κ°μ›”)
- [ ] Range/Intensity μ΄λ―Έμ§€ μƒμ„±
- [ ] 2D κ°μ²΄ κ²€μ¶ ν†µν•©
- [ ] λ©€ν‹°λ¨λ‹¬ νΉμ§• μµν•©

### Phase 4: ν™•μ¥μ„± (2-3κ°μ›”)
- [ ] λ‹¤λ¥Έ LiDAR λ¨λΈ μ§€μ›
- [ ] λ™μ  ν•΄μƒλ„ μ΅°μ •
- [ ] GPU κ°€μ† μµμ…

## 5. μ„¤κ³„ μ›μΉ™

1. **μ•μ •μ„± μ°μ„ **: μ •ν™•λ„ > μ†λ„
2. **λ¨λ“ν™”**: κ° κΈ°λ¥μ„ λ…λ¦½μ μΌλ΅ κ°λ°/ν…μ¤νΈ
3. **μ‹¤μ‹κ°„μ„±**: μ„Όμ„ μ£Όνμ(10Hz) μ΄μƒ μ μ§€
4. **ν™•μ¥μ„±**: μƒλ΅μ΄ μ„Όμ„/μ•κ³ λ¦¬μ¦ μ‰½κ² μ¶”κ°€

## 6. λ¦¬μ¤ν¬ λ° λ€μ‘

### κΈ°μ μ  λ¦¬μ¤ν¬
- **λ©”λ¨λ¦¬ λ€μ—­ν­**: λ³‘λ ¬ν™”λ΅ μΈν• μΊμ‹ λ―Έμ¤
  - λ€μ‘: νƒ€μΌ κΈ°λ° μ²λ¦¬ κ³ λ ¤

- **λ μ΄ν„΄μ‹**: λ‹¤μ΄μ¤νΈλ¦Ό μ²λ¦¬ μ§€μ—°
  - λ€μ‘: νμ΄ν”„λΌμΈ μµμ ν™”

### μ΄μ λ¦¬μ¤ν¬
- **μ„Όμ„ λ³€κ²½**: OS1-32 μ™Έ λ¨λΈ μ”κµ¬
  - λ€μ‘: μ„¤μ • νμΌ κΈ°λ° ν™•μ¥

## 7. κ°λ° λ΅λ“λ§µ

```
2024 Q1: μ½”μ–΄ λ³΄κ°„ μ—”μ§„ β…
2024 Q2: μ„±λ¥ μµμ ν™” λ° μΉ΄λ©”λΌ μµν•© π”„
2024 Q3: κ³ κΈ‰ κΈ°λ¥ λ° ν™•μ¥μ„±
2024 Q4: ν”„λ΅λ•μ… μ¤€λΉ„ λ° λ°°ν¬
```

## 8. μ°Έκ³  μλ£

- [Ouster κ³µμ‹ λ¬Έμ„](https://static.ouster.dev/sensor-docs/)
- [ROS2 ν¬μΈνΈν΄λΌμ°λ“ μ²λ¦¬](https://docs.ros.org/en/humble/Tutorials/Intermediate/PointCloud2-Tutorials.html)
- [PCL λΌμ΄λΈλ¬λ¦¬](https://pointclouds.org/)